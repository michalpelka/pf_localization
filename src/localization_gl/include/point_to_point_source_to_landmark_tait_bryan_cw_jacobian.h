inline void point_to_point_source_to_landmark_tait_bryan_cw(double &delta_x, double &delta_y, double &delta_z, double tx, double ty, double tz, double om, double fi, double ka, double x_s, double y_s, double z_s, double x_L, double y_L, double z_L)
{delta_x = tx*cos(fi)*cos(ka) - ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) - tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + x_L - x_s*cos(fi)*cos(ka) - y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om));
delta_y = -tx*sin(ka)*cos(fi) - ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + x_s*sin(ka)*cos(fi) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka));
delta_z = tx*sin(fi) - ty*sin(om)*cos(fi) + tz*cos(fi)*cos(om) - x_s*sin(fi) + y_s*sin(om)*cos(fi) + z_L - z_s*cos(fi)*cos(om);
}
inline void point_to_point_source_to_landmark_tait_bryan_cw_jacobian(Eigen::Matrix<double, 3, 6, Eigen::RowMajor> &j, double tx, double ty, double tz, double om, double fi, double ka, double x_s, double y_s, double z_s, double x_L, double y_L, double z_L)
{j.coeffRef(0,0) = cos(fi)*cos(ka);
j.coeffRef(0,1) = sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om);
j.coeffRef(0,2) = -sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om);
j.coeffRef(0,3) = -ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) - y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om));
j.coeffRef(0,4) = -tx*sin(fi)*cos(ka) + ty*sin(om)*cos(fi)*cos(ka) - tz*cos(fi)*cos(ka)*cos(om) + x_s*sin(fi)*cos(ka) - y_s*sin(om)*cos(fi)*cos(ka) + z_s*cos(fi)*cos(ka)*cos(om);
j.coeffRef(0,5) = -tx*sin(ka)*cos(fi) - ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + x_s*sin(ka)*cos(fi) - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka));
j.coeffRef(1,0) = -sin(ka)*cos(fi);
j.coeffRef(1,1) = -sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om);
j.coeffRef(1,2) = sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka);
j.coeffRef(1,3) = -ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om));
j.coeffRef(1,4) = tx*sin(fi)*sin(ka) - ty*sin(ka)*sin(om)*cos(fi) + tz*sin(ka)*cos(fi)*cos(om) - x_s*sin(fi)*sin(ka) + y_s*sin(ka)*sin(om)*cos(fi) - z_s*sin(ka)*cos(fi)*cos(om);
j.coeffRef(1,5) = -tx*cos(fi)*cos(ka) - ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + x_s*cos(fi)*cos(ka) - y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) - z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om));
j.coeffRef(2,0) = sin(fi);
j.coeffRef(2,1) = -sin(om)*cos(fi);
j.coeffRef(2,2) = cos(fi)*cos(om);
j.coeffRef(2,3) = -ty*cos(fi)*cos(om) - tz*sin(om)*cos(fi) + y_s*cos(fi)*cos(om) + z_s*sin(om)*cos(fi);
j.coeffRef(2,4) = tx*cos(fi) + ty*sin(fi)*sin(om) - tz*sin(fi)*cos(om) - x_s*cos(fi) - y_s*sin(fi)*sin(om) + z_s*sin(fi)*cos(om);
j.coeffRef(2,5) = 0;
}inline void point_to_point_source_to_landmark_tait_bryan_cw_hessian(Eigen::Matrix<double, 6, 6, Eigen::RowMajor> &j, double tx, double ty, double tz, double om, double fi, double ka, double x_s, double y_s, double z_s, double x_L, double y_L, double z_L)
{j.coeffRef(0,0) = 2*pow(sin(fi), 2) + 2*pow(sin(ka), 2)*pow(cos(fi), 2) + 2*pow(cos(fi), 2)*pow(cos(ka), 2);
j.coeffRef(0,1) = (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*sin(ka)*cos(fi) + (2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*cos(fi)*cos(ka) - 2*sin(fi)*sin(om)*cos(fi);
j.coeffRef(0,2) = (-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*sin(ka)*cos(fi) + (-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*cos(fi)*cos(ka) + 2*sin(fi)*cos(fi)*cos(om);
j.coeffRef(0,3) = (2*ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*sin(ka)*cos(fi) + (-2*ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) - 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*cos(fi)*cos(ka) + (-2*ty*cos(fi)*cos(om) - 2*tz*sin(om)*cos(fi) + 2*y_s*cos(fi)*cos(om) + 2*z_s*sin(om)*cos(fi))*sin(fi);
j.coeffRef(0,4) = (2*tx*cos(fi) + 2*ty*sin(fi)*sin(om) - 2*tz*sin(fi)*cos(om) - 2*x_s*cos(fi) - 2*y_s*sin(fi)*sin(om) + 2*z_s*sin(fi)*cos(om))*sin(fi) + (-2*tx*sin(fi)*sin(ka) + 2*ty*sin(ka)*sin(om)*cos(fi) - 2*tz*sin(ka)*cos(fi)*cos(om) + 2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(ka)*cos(fi)*cos(om))*sin(ka)*cos(fi) + (-2*tx*sin(fi)*cos(ka) + 2*ty*sin(om)*cos(fi)*cos(ka) - 2*tz*cos(fi)*cos(ka)*cos(om) + 2*x_s*sin(fi)*cos(ka) - 2*y_s*sin(om)*cos(fi)*cos(ka) + 2*z_s*cos(fi)*cos(ka)*cos(om))*cos(fi)*cos(ka) + (2*tx*sin(fi) - 2*ty*sin(om)*cos(fi) + 2*tz*cos(fi)*cos(om) - 2*x_s*sin(fi) + 2*y_s*sin(om)*cos(fi) + 2*z_L - 2*z_s*cos(fi)*cos(om))*cos(fi) - (2*tx*sin(ka)*cos(fi) + 2*ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*x_s*sin(ka)*cos(fi) - 2*y_L + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(fi)*sin(ka) - (2*tx*cos(fi)*cos(ka) - 2*ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) - 2*tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*x_L - 2*x_s*cos(fi)*cos(ka) - 2*y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(fi)*cos(ka);
j.coeffRef(0,5) = (-2*tx*sin(ka)*cos(fi) - 2*ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - 2*tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*x_s*sin(ka)*cos(fi) - 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*cos(fi)*cos(ka) + (2*tx*cos(fi)*cos(ka) + 2*ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*x_s*cos(fi)*cos(ka) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*sin(ka)*cos(fi) + (2*tx*sin(ka)*cos(fi) + 2*ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*x_s*sin(ka)*cos(fi) - 2*y_L + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*cos(fi)*cos(ka) - (2*tx*cos(fi)*cos(ka) - 2*ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) - 2*tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*x_L - 2*x_s*cos(fi)*cos(ka) - 2*y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(ka)*cos(fi);
j.coeffRef(1,0) = (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*sin(ka)*cos(fi) - (-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*cos(fi)*cos(ka) - 2*sin(fi)*sin(om)*cos(fi);
j.coeffRef(1,1) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om)) + (-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*pow(sin(om), 2)*pow(cos(fi), 2);
j.coeffRef(1,2) = (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + (-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*sin(om)*pow(cos(fi), 2)*cos(om);
j.coeffRef(1,3) = (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + (2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + (-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (2*ty*cos(fi)*cos(om) + 2*tz*sin(om)*cos(fi) - 2*y_s*cos(fi)*cos(om) - 2*z_s*sin(om)*cos(fi))*sin(om)*cos(fi) + (-2*tx*sin(fi) + 2*ty*sin(om)*cos(fi) - 2*tz*cos(fi)*cos(om) + 2*x_s*sin(fi) - 2*y_s*sin(om)*cos(fi) - 2*z_L + 2*z_s*cos(fi)*cos(om))*cos(fi)*cos(om);
j.coeffRef(1,4) = (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(-tx*sin(fi)*sin(ka) + ty*sin(ka)*sin(om)*cos(fi) - tz*sin(ka)*cos(fi)*cos(om) + x_s*sin(fi)*sin(ka) - y_s*sin(ka)*sin(om)*cos(fi) + z_s*sin(ka)*cos(fi)*cos(om)) + (-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(tx*sin(fi)*cos(ka) - ty*sin(om)*cos(fi)*cos(ka) + tz*cos(fi)*cos(ka)*cos(om) - x_s*sin(fi)*cos(ka) + y_s*sin(om)*cos(fi)*cos(ka) - z_s*cos(fi)*cos(ka)*cos(om)) + (-2*tx*cos(fi) - 2*ty*sin(fi)*sin(om) + 2*tz*sin(fi)*cos(om) + 2*x_s*cos(fi) + 2*y_s*sin(fi)*sin(om) - 2*z_s*sin(fi)*cos(om))*sin(om)*cos(fi) - (-2*tx*sin(fi) + 2*ty*sin(om)*cos(fi) - 2*tz*cos(fi)*cos(om) + 2*x_s*sin(fi) - 2*y_s*sin(om)*cos(fi) - 2*z_L + 2*z_s*cos(fi)*cos(om))*sin(fi)*sin(om) + 2*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*sin(om)*cos(fi) - 2*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(om)*cos(fi)*cos(ka);
j.coeffRef(1,5) = (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(tx*cos(fi)*cos(ka) + ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - x_s*cos(fi)*cos(ka) + y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)));
j.coeffRef(2,0) = (-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*sin(ka)*cos(fi) - (2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*cos(fi)*cos(ka) + 2*sin(fi)*cos(fi)*cos(om);
j.coeffRef(2,1) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka)) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om)) - 2*sin(om)*pow(cos(fi), 2)*cos(om);
j.coeffRef(2,2) = (-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om)) + 2*pow(cos(fi), 2)*pow(cos(om), 2);
j.coeffRef(2,3) = (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + (-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + (-2*ty*cos(fi)*cos(om) - 2*tz*sin(om)*cos(fi) + 2*y_s*cos(fi)*cos(om) + 2*z_s*sin(om)*cos(fi))*cos(fi)*cos(om) - (2*tx*sin(fi) - 2*ty*sin(om)*cos(fi) + 2*tz*cos(fi)*cos(om) - 2*x_s*sin(fi) + 2*y_s*sin(om)*cos(fi) + 2*z_L - 2*z_s*cos(fi)*cos(om))*sin(om)*cos(fi);
j.coeffRef(2,4) = (-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(-tx*sin(fi)*sin(ka) + ty*sin(ka)*sin(om)*cos(fi) - tz*sin(ka)*cos(fi)*cos(om) + x_s*sin(fi)*sin(ka) - y_s*sin(ka)*sin(om)*cos(fi) + z_s*sin(ka)*cos(fi)*cos(om)) + (2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(tx*sin(fi)*cos(ka) - ty*sin(om)*cos(fi)*cos(ka) + tz*cos(fi)*cos(ka)*cos(om) - x_s*sin(fi)*cos(ka) + y_s*sin(om)*cos(fi)*cos(ka) - z_s*cos(fi)*cos(ka)*cos(om)) + (2*tx*cos(fi) + 2*ty*sin(fi)*sin(om) - 2*tz*sin(fi)*cos(om) - 2*x_s*cos(fi) - 2*y_s*sin(fi)*sin(om) + 2*z_s*sin(fi)*cos(om))*cos(fi)*cos(om) - (2*tx*sin(fi) - 2*ty*sin(om)*cos(fi) + 2*tz*cos(fi)*cos(om) - 2*x_s*sin(fi) + 2*y_s*sin(om)*cos(fi) + 2*z_L - 2*z_s*cos(fi)*cos(om))*sin(fi)*cos(om) - 2*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)*cos(om) + 2*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)*cos(om);
j.coeffRef(2,5) = (-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(tx*cos(fi)*cos(ka) + ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - x_s*cos(fi)*cos(ka) + y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)));
j.coeffRef(3,0) = (2*ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*sin(ka)*cos(fi) - (2*ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*cos(fi)*cos(ka) - (2*ty*cos(fi)*cos(om) + 2*tz*sin(om)*cos(fi) - 2*y_s*cos(fi)*cos(om) - 2*z_s*sin(om)*cos(fi))*sin(fi);
j.coeffRef(3,1) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(2*ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + (2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(2*ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + (-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (2*ty*cos(fi)*cos(om) + 2*tz*sin(om)*cos(fi) - 2*y_s*cos(fi)*cos(om) - 2*z_s*sin(om)*cos(fi))*sin(om)*cos(fi) + 2*(-tx*sin(fi) + ty*sin(om)*cos(fi) - tz*cos(fi)*cos(om) + x_s*sin(fi) - y_s*sin(om)*cos(fi) - z_L + z_s*cos(fi)*cos(om))*cos(fi)*cos(om);
j.coeffRef(3,2) = (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(2*ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + (-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(2*ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) - (2*ty*cos(fi)*cos(om) + 2*tz*sin(om)*cos(fi) - 2*y_s*cos(fi)*cos(om) - 2*z_s*sin(om)*cos(fi))*cos(fi)*cos(om) + 2*(-tx*sin(fi) + ty*sin(om)*cos(fi) - tz*cos(fi)*cos(om) + x_s*sin(fi) - y_s*sin(om)*cos(fi) - z_L + z_s*cos(fi)*cos(om))*sin(om)*cos(fi);
j.coeffRef(3,3) = (2*ty*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*y_s*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*z_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(2*ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + (2*ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(2*ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + (-2*ty*sin(om)*cos(fi) + 2*tz*cos(fi)*cos(om) + 2*y_s*sin(om)*cos(fi) - 2*z_s*cos(fi)*cos(om))*(-tx*sin(fi) + ty*sin(om)*cos(fi) - tz*cos(fi)*cos(om) + x_s*sin(fi) - y_s*sin(om)*cos(fi) - z_L + z_s*cos(fi)*cos(om)) + (ty*cos(fi)*cos(om) + tz*sin(om)*cos(fi) - y_s*cos(fi)*cos(om) - z_s*sin(om)*cos(fi))*(2*ty*cos(fi)*cos(om) + 2*tz*sin(om)*cos(fi) - 2*y_s*cos(fi)*cos(om) - 2*z_s*sin(om)*cos(fi));
j.coeffRef(3,4) = (2*ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(-tx*sin(fi)*sin(ka) + ty*sin(ka)*sin(om)*cos(fi) - tz*sin(ka)*cos(fi)*cos(om) + x_s*sin(fi)*sin(ka) - y_s*sin(ka)*sin(om)*cos(fi) + z_s*sin(ka)*cos(fi)*cos(om)) + (2*ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(tx*sin(fi)*cos(ka) - ty*sin(om)*cos(fi)*cos(ka) + tz*cos(fi)*cos(ka)*cos(om) - x_s*sin(fi)*cos(ka) + y_s*sin(om)*cos(fi)*cos(ka) - z_s*cos(fi)*cos(ka)*cos(om)) + (-2*ty*sin(fi)*cos(om) - 2*tz*sin(fi)*sin(om) + 2*y_s*sin(fi)*cos(om) + 2*z_s*sin(fi)*sin(om))*(-tx*sin(fi) + ty*sin(om)*cos(fi) - tz*cos(fi)*cos(om) + x_s*sin(fi) - y_s*sin(om)*cos(fi) - z_L + z_s*cos(fi)*cos(om)) + (2*ty*cos(fi)*cos(om) + 2*tz*sin(om)*cos(fi) - 2*y_s*cos(fi)*cos(om) - 2*z_s*sin(om)*cos(fi))*(-tx*cos(fi) - ty*sin(fi)*sin(om) + tz*sin(fi)*cos(om) + x_s*cos(fi) + y_s*sin(fi)*sin(om) - z_s*sin(fi)*cos(om)) + (2*ty*sin(ka)*cos(fi)*cos(om) + 2*tz*sin(ka)*sin(om)*cos(fi) - 2*y_s*sin(ka)*cos(fi)*cos(om) - 2*z_s*sin(ka)*sin(om)*cos(fi))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (-2*ty*cos(fi)*cos(ka)*cos(om) - 2*tz*sin(om)*cos(fi)*cos(ka) + 2*y_s*cos(fi)*cos(ka)*cos(om) + 2*z_s*sin(om)*cos(fi)*cos(ka))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)));
j.coeffRef(3,5) = (2*ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(tx*cos(fi)*cos(ka) + ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - x_s*cos(fi)*cos(ka) + y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (2*ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (2*ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (2*ty*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*y_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*z_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)));
j.coeffRef(4,0) = -(-2*tx*cos(fi) - 2*ty*sin(fi)*sin(om) + 2*tz*sin(fi)*cos(om) + 2*x_s*cos(fi) + 2*y_s*sin(fi)*sin(om) - 2*z_s*sin(fi)*cos(om))*sin(fi) + (-2*tx*sin(fi)*sin(ka) + 2*ty*sin(ka)*sin(om)*cos(fi) - 2*tz*sin(ka)*cos(fi)*cos(om) + 2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(ka)*cos(fi)*cos(om))*sin(ka)*cos(fi) - (2*tx*sin(fi)*cos(ka) - 2*ty*sin(om)*cos(fi)*cos(ka) + 2*tz*cos(fi)*cos(ka)*cos(om) - 2*x_s*sin(fi)*cos(ka) + 2*y_s*sin(om)*cos(fi)*cos(ka) - 2*z_s*cos(fi)*cos(ka)*cos(om))*cos(fi)*cos(ka) - 2*(-tx*sin(fi) + ty*sin(om)*cos(fi) - tz*cos(fi)*cos(om) + x_s*sin(fi) - y_s*sin(om)*cos(fi) - z_L + z_s*cos(fi)*cos(om))*cos(fi) - 2*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(fi)*sin(ka) + 2*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(fi)*cos(ka);
j.coeffRef(4,1) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(-2*tx*sin(fi)*sin(ka) + 2*ty*sin(ka)*sin(om)*cos(fi) - 2*tz*sin(ka)*cos(fi)*cos(om) + 2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(ka)*cos(fi)*cos(om)) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(2*tx*sin(fi)*cos(ka) - 2*ty*sin(om)*cos(fi)*cos(ka) + 2*tz*cos(fi)*cos(ka)*cos(om) - 2*x_s*sin(fi)*cos(ka) + 2*y_s*sin(om)*cos(fi)*cos(ka) - 2*z_s*cos(fi)*cos(ka)*cos(om)) + (-2*tx*cos(fi) - 2*ty*sin(fi)*sin(om) + 2*tz*sin(fi)*cos(om) + 2*x_s*cos(fi) + 2*y_s*sin(fi)*sin(om) - 2*z_s*sin(fi)*cos(om))*sin(om)*cos(fi) - 2*(-tx*sin(fi) + ty*sin(om)*cos(fi) - tz*cos(fi)*cos(om) + x_s*sin(fi) - y_s*sin(om)*cos(fi) - z_L + z_s*cos(fi)*cos(om))*sin(fi)*sin(om) + 2*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*sin(om)*cos(fi) - 2*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(om)*cos(fi)*cos(ka);
j.coeffRef(4,2) = (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(-2*tx*sin(fi)*sin(ka) + 2*ty*sin(ka)*sin(om)*cos(fi) - 2*tz*sin(ka)*cos(fi)*cos(om) + 2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(ka)*cos(fi)*cos(om)) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(2*tx*sin(fi)*cos(ka) - 2*ty*sin(om)*cos(fi)*cos(ka) + 2*tz*cos(fi)*cos(ka)*cos(om) - 2*x_s*sin(fi)*cos(ka) + 2*y_s*sin(om)*cos(fi)*cos(ka) - 2*z_s*cos(fi)*cos(ka)*cos(om)) - (-2*tx*cos(fi) - 2*ty*sin(fi)*sin(om) + 2*tz*sin(fi)*cos(om) + 2*x_s*cos(fi) + 2*y_s*sin(fi)*sin(om) - 2*z_s*sin(fi)*cos(om))*cos(fi)*cos(om) + 2*(-tx*sin(fi) + ty*sin(om)*cos(fi) - tz*cos(fi)*cos(om) + x_s*sin(fi) - y_s*sin(om)*cos(fi) - z_L + z_s*cos(fi)*cos(om))*sin(fi)*cos(om) - 2*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)*cos(om) + 2*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)*cos(om);
j.coeffRef(4,3) = (ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(-2*tx*sin(fi)*sin(ka) + 2*ty*sin(ka)*sin(om)*cos(fi) - 2*tz*sin(ka)*cos(fi)*cos(om) + 2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(ka)*cos(fi)*cos(om)) + (ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(2*tx*sin(fi)*cos(ka) - 2*ty*sin(om)*cos(fi)*cos(ka) + 2*tz*cos(fi)*cos(ka)*cos(om) - 2*x_s*sin(fi)*cos(ka) + 2*y_s*sin(om)*cos(fi)*cos(ka) - 2*z_s*cos(fi)*cos(ka)*cos(om)) + (-2*ty*sin(fi)*cos(om) - 2*tz*sin(fi)*sin(om) + 2*y_s*sin(fi)*cos(om) + 2*z_s*sin(fi)*sin(om))*(-tx*sin(fi) + ty*sin(om)*cos(fi) - tz*cos(fi)*cos(om) + x_s*sin(fi) - y_s*sin(om)*cos(fi) - z_L + z_s*cos(fi)*cos(om)) + (ty*cos(fi)*cos(om) + tz*sin(om)*cos(fi) - y_s*cos(fi)*cos(om) - z_s*sin(om)*cos(fi))*(-2*tx*cos(fi) - 2*ty*sin(fi)*sin(om) + 2*tz*sin(fi)*cos(om) + 2*x_s*cos(fi) + 2*y_s*sin(fi)*sin(om) - 2*z_s*sin(fi)*cos(om)) + (2*ty*sin(ka)*cos(fi)*cos(om) + 2*tz*sin(ka)*sin(om)*cos(fi) - 2*y_s*sin(ka)*cos(fi)*cos(om) - 2*z_s*sin(ka)*sin(om)*cos(fi))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (-2*ty*cos(fi)*cos(ka)*cos(om) - 2*tz*sin(om)*cos(fi)*cos(ka) + 2*y_s*cos(fi)*cos(ka)*cos(om) + 2*z_s*sin(om)*cos(fi)*cos(ka))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)));
j.coeffRef(4,4) = (2*tx*sin(fi) - 2*ty*sin(om)*cos(fi) + 2*tz*cos(fi)*cos(om) - 2*x_s*sin(fi) + 2*y_s*sin(om)*cos(fi) - 2*z_s*cos(fi)*cos(om))*(-tx*sin(fi) + ty*sin(om)*cos(fi) - tz*cos(fi)*cos(om) + x_s*sin(fi) - y_s*sin(om)*cos(fi) - z_L + z_s*cos(fi)*cos(om)) + (-2*tx*cos(fi) - 2*ty*sin(fi)*sin(om) + 2*tz*sin(fi)*cos(om) + 2*x_s*cos(fi) + 2*y_s*sin(fi)*sin(om) - 2*z_s*sin(fi)*cos(om))*(-tx*cos(fi) - ty*sin(fi)*sin(om) + tz*sin(fi)*cos(om) + x_s*cos(fi) + y_s*sin(fi)*sin(om) - z_s*sin(fi)*cos(om)) + (-2*tx*sin(fi)*sin(ka) + 2*ty*sin(ka)*sin(om)*cos(fi) - 2*tz*sin(ka)*cos(fi)*cos(om) + 2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(ka)*cos(fi)*cos(om))*(-tx*sin(fi)*sin(ka) + ty*sin(ka)*sin(om)*cos(fi) - tz*sin(ka)*cos(fi)*cos(om) + x_s*sin(fi)*sin(ka) - y_s*sin(ka)*sin(om)*cos(fi) + z_s*sin(ka)*cos(fi)*cos(om)) + (tx*sin(fi)*cos(ka) - ty*sin(om)*cos(fi)*cos(ka) + tz*cos(fi)*cos(ka)*cos(om) - x_s*sin(fi)*cos(ka) + y_s*sin(om)*cos(fi)*cos(ka) - z_s*cos(fi)*cos(ka)*cos(om))*(2*tx*sin(fi)*cos(ka) - 2*ty*sin(om)*cos(fi)*cos(ka) + 2*tz*cos(fi)*cos(ka)*cos(om) - 2*x_s*sin(fi)*cos(ka) + 2*y_s*sin(om)*cos(fi)*cos(ka) - 2*z_s*cos(fi)*cos(ka)*cos(om)) + (-2*tx*sin(ka)*cos(fi) - 2*ty*sin(fi)*sin(ka)*sin(om) + 2*tz*sin(fi)*sin(ka)*cos(om) + 2*x_s*sin(ka)*cos(fi) + 2*y_s*sin(fi)*sin(ka)*sin(om) - 2*z_s*sin(fi)*sin(ka)*cos(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (2*tx*cos(fi)*cos(ka) + 2*ty*sin(fi)*sin(om)*cos(ka) - 2*tz*sin(fi)*cos(ka)*cos(om) - 2*x_s*cos(fi)*cos(ka) - 2*y_s*sin(fi)*sin(om)*cos(ka) + 2*z_s*sin(fi)*cos(ka)*cos(om))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)));
j.coeffRef(4,5) = (-2*tx*sin(fi)*sin(ka) + 2*ty*sin(ka)*sin(om)*cos(fi) - 2*tz*sin(ka)*cos(fi)*cos(om) + 2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(ka)*cos(fi)*cos(om))*(tx*cos(fi)*cos(ka) + ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - x_s*cos(fi)*cos(ka) + y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (-2*tx*sin(fi)*sin(ka) + 2*ty*sin(ka)*sin(om)*cos(fi) - 2*tz*sin(ka)*cos(fi)*cos(om) + 2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(ka)*cos(fi)*cos(om))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (-2*tx*sin(fi)*cos(ka) + 2*ty*sin(om)*cos(fi)*cos(ka) - 2*tz*cos(fi)*cos(ka)*cos(om) + 2*x_s*sin(fi)*cos(ka) - 2*y_s*sin(om)*cos(fi)*cos(ka) + 2*z_s*cos(fi)*cos(ka)*cos(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (2*tx*sin(fi)*cos(ka) - 2*ty*sin(om)*cos(fi)*cos(ka) + 2*tz*cos(fi)*cos(ka)*cos(om) - 2*x_s*sin(fi)*cos(ka) + 2*y_s*sin(om)*cos(fi)*cos(ka) - 2*z_s*cos(fi)*cos(ka)*cos(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)));
j.coeffRef(5,0) = -(2*tx*sin(ka)*cos(fi) + 2*ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*x_s*sin(ka)*cos(fi) + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*cos(fi)*cos(ka) + (2*tx*cos(fi)*cos(ka) + 2*ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*x_s*cos(fi)*cos(ka) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*sin(ka)*cos(fi) + 2*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*cos(fi)*cos(ka) + 2*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(ka)*cos(fi);
j.coeffRef(5,1) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(2*tx*cos(fi)*cos(ka) + 2*ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*x_s*cos(fi)*cos(ka) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(2*tx*sin(ka)*cos(fi) + 2*ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*x_s*sin(ka)*cos(fi) + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)));
j.coeffRef(5,2) = (-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(2*tx*cos(fi)*cos(ka) + 2*ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*x_s*cos(fi)*cos(ka) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(2*tx*sin(ka)*cos(fi) + 2*ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*x_s*sin(ka)*cos(fi) + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)));
j.coeffRef(5,3) = (ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(2*tx*cos(fi)*cos(ka) + 2*ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*x_s*cos(fi)*cos(ka) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (2*ty*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (ty*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + z_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(2*tx*sin(ka)*cos(fi) + 2*ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*x_s*sin(ka)*cos(fi) + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (2*ty*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*y_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*z_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)));
j.coeffRef(5,4) = (-2*tx*sin(fi)*sin(ka) + 2*ty*sin(ka)*sin(om)*cos(fi) - 2*tz*sin(ka)*cos(fi)*cos(om) + 2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(ka)*cos(fi)*cos(om))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) + (-tx*sin(fi)*sin(ka) + ty*sin(ka)*sin(om)*cos(fi) - tz*sin(ka)*cos(fi)*cos(om) + x_s*sin(fi)*sin(ka) - y_s*sin(ka)*sin(om)*cos(fi) + z_s*sin(ka)*cos(fi)*cos(om))*(2*tx*cos(fi)*cos(ka) + 2*ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*x_s*cos(fi)*cos(ka) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (-2*tx*sin(fi)*cos(ka) + 2*ty*sin(om)*cos(fi)*cos(ka) - 2*tz*cos(fi)*cos(ka)*cos(om) + 2*x_s*sin(fi)*cos(ka) - 2*y_s*sin(om)*cos(fi)*cos(ka) + 2*z_s*cos(fi)*cos(ka)*cos(om))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (tx*sin(fi)*cos(ka) - ty*sin(om)*cos(fi)*cos(ka) + tz*cos(fi)*cos(ka)*cos(om) - x_s*sin(fi)*cos(ka) + y_s*sin(om)*cos(fi)*cos(ka) - z_s*cos(fi)*cos(ka)*cos(om))*(2*tx*sin(ka)*cos(fi) + 2*ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*x_s*sin(ka)*cos(fi) + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)));
j.coeffRef(5,5) = (-2*tx*sin(ka)*cos(fi) + 2*ty*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*x_s*sin(ka)*cos(fi) + 2*y_s*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*z_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)))*(tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) - y_L + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (tx*sin(ka)*cos(fi) + ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - x_s*sin(ka)*cos(fi) + y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*tx*sin(ka)*cos(fi) + 2*ty*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*x_s*sin(ka)*cos(fi) + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + (tx*cos(fi)*cos(ka) + ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - x_s*cos(fi)*cos(ka) + y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(2*tx*cos(fi)*cos(ka) + 2*ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*x_s*cos(fi)*cos(ka) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (2*tx*cos(fi)*cos(ka) + 2*ty*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*x_s*cos(fi)*cos(ka) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*z_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(-tx*cos(fi)*cos(ka) + ty*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - x_L + x_s*cos(fi)*cos(ka) + y_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + z_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)));
}